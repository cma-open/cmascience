# example schedule release
# using calver https://calver.org/calendar_versioning.html
# calver YYYY.0M.0D.MICRO

name: Scheduled  automated release

on:
  #push:
    #branches:
    #  - master
  schedule:
    - cron: "*/5 * * * *" # Every 10 mins
    #- cron: '24 */24 * * *'  # Once a day
    #- cron: '0 0 * * *' # Once a day
    #- cron: '0 0 1 * *' # Once per month
    #- cron: '0 0 1 */2 *' # Every other month (1st day of month)
    #- cron: # Once per quarter

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
    #- uses: actions/checkout@v1
        #with:
        #repo-token: ${{ secrets.GITHUB_TOKEN }}
    - name: Get current date
      id: date
      run: echo "::set-output name=date::$(date +'%Y.%m.%d.T%H%M.Dev')"
      #run: echo "::set-output name=date::$(date +'%Y.%m.%d.Dev')"
    - name: Compile Release Notes
      id: notes
      run: echo "::set-output name=body::'Release notes text here')"
    - name: Create a repo level release event
      run: |
        curl -X POST \
        -H "Accept: application/vnd.github.v3+json" \
        -u ${{ secrets.ACCESS_TOKEN }} \
        https://api.github.com/repos/cma-open/cmascience/releases \
        -d '{"tag_name":"v${{ steps.date.outputs.date }}","prerelease":"true",  "body": "${{ steps.notes.outputs.body }}" }' 
        #-d '{"name":"test_name"}'
        #-d '{"prerelease":"true"}'
         
       

